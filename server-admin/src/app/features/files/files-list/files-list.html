<div class="w-full max-w-full px-2 sm:px-4 py-8">
  <h1 class="text-3xl font-bold mb-6 text-gray-900 dark:text-gray-100">Files</h1>

  <!-- Filters -->
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4 mb-6 transition-colors duration-200">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
          >Search</label
        >
        <div class="flex">
          <input
            type="text"
            [ngModel]="searchQuery()"
            (ngModelChange)="searchQuery.set($event)"
            (keyup.enter)="onSearch()"
            placeholder="Search by name..."
            class="flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-l-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
          />
          <button
            (click)="onSearch()"
            class="px-4 py-2 bg-blue-600 dark:bg-blue-700 text-white rounded-r-md hover:bg-blue-700 dark:hover:bg-blue-600"
          >
            Search
          </button>
        </div>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
          >Watch Folder</label
        >
        <select
          [ngModel]="selectedWatchFolder()"
          (ngModelChange)="selectedWatchFolder.set($event); onWatchFolderChange()"
          class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
        >
          <option [value]="null">All Folders</option>
          <option *ngFor="let folder of watchFolders()" [value]="folder.id">
            {{ folder.name || folder.path }}
          </option>
        </select>
      </div>
    </div>
  </div>

  <!-- Error Message -->
  <div
    *ngIf="error()"
    class="bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded mb-4"
  >
    {{ error() }}
  </div>

  <!-- Loading State -->
  <div *ngIf="loading()" class="text-center py-8">
    <div
      class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-gray-100"
    ></div>
    <p class="mt-2 text-gray-600 dark:text-gray-400">Loading files...</p>
  </div>

  <!-- Files List -->
  <app-files-table
    *ngIf="!loading()"
    [files]="files()"
    [watchFolders]="watchFolders()"
    [showActions]="true"
    [showThumbnail]="true"
    [showWatchFolder]="true"
    [showAddedDate]="false"
    [onFileClick]="openFileDetails.bind(this)"
  ></app-files-table>

  <!-- File Details Modal -->
  <app-file-details-modal
    [file]="selectedFile()"
    [watchFolders]="watchFolders()"
    (close)="closeFileDetails()"
  ></app-file-details-modal>
</div>
